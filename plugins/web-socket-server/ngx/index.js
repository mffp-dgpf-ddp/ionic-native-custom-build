import { __decorate, __extends } from "tslib";
import { Injectable } from '@angular/core';
import { IonicNativePlugin, cordova } from '@ionic-native/core';
import { Observable } from 'rxjs';
var WebSocketServer = /** @class */ (function (_super) {
    __extends(WebSocketServer, _super);
    function WebSocketServer() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WebSocketServer.prototype.getInterfaces = function () { return cordova(this, "getInterfaces", {}, arguments); };
    WebSocketServer.prototype.start = function (port, options) { return cordova(this, "start", { "observable": true, "clearFunction": "stop" }, arguments); };
    WebSocketServer.prototype.onFunctionToObservable = function (fnName) {
        return new Observable(function (observer) {
            var id = window.cordova.plugins.wsserver[fnName](observer.next.bind(observer), observer.error.bind(observer));
            return function () { return window.cordova.plugins.wsserver.removeCallback(id); };
        });
    };
    /**
     * Watches for new messages
     * @return {Observable<WebSocketMessage>}
     */
    WebSocketServer.prototype.watchMessage = function () {
        return this.onFunctionToObservable('onMessage');
    };
    /**
     * Watches for new opened connections
     * @return {Observable<WebSocketConnection>}
     */
    WebSocketServer.prototype.watchOpen = function () {
        return this.onFunctionToObservable('onOpen');
    };
    /**
     * Watches for closed connections
     * @return {Observable<WebSocketClose>}
     */
    WebSocketServer.prototype.watchClose = function () {
        return this.onFunctionToObservable('onClose');
    };
    /**
     * Watches for any websocket failures
     * @return {Observable<WebSocketFailure>}
     */
    WebSocketServer.prototype.watchFailure = function () {
        return this.onFunctionToObservable('onFailure');
    };
    WebSocketServer.prototype.stop = function () { return cordova(this, "stop", {}, arguments); };
    WebSocketServer.prototype.send = function (conn, msg) { return cordova(this, "send", {}, arguments); };
    WebSocketServer.prototype.close = function (conn, code, reason) { return cordova(this, "close", {}, arguments); };
    WebSocketServer.pluginName = "WebSocketServer";
    WebSocketServer.plugin = "cordova-plugin-websocket-server";
    WebSocketServer.pluginRef = "cordova.plugins.wsserver";
    WebSocketServer.repo = "https://github.com/becvert/cordova-plugin-websocket-server";
    WebSocketServer.platforms = ["Android", "iOS"];
    WebSocketServer = __decorate([
        Injectable()
    ], WebSocketServer);
    return WebSocketServer;
}(IonicNativePlugin));
export { WebSocketServer };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvQGlvbmljLW5hdGl2ZS9wbHVnaW5zL3dlYi1zb2NrZXQtc2VydmVyL25neC9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLDhCQUFzQyxNQUFNLG9CQUFvQixDQUFDO0FBQ3hFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxNQUFNLENBQUM7O0lBNEdHLG1DQUFpQjs7OztJQU1wRCx1Q0FBYTtJQWNiLCtCQUFLLGFBQUMsSUFBWSxFQUFFLE9BQXlCO0lBSXJDLGdEQUFzQixHQUE5QixVQUFrQyxNQUFjO1FBQzlDLE9BQU8sSUFBSSxVQUFVLENBQUksVUFBQSxRQUFRO1lBQy9CLElBQU0sRUFBRSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBRWhILE9BQU8sY0FBTSxPQUFBLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLEVBQWxELENBQWtELENBQUM7UUFDbEUsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsc0NBQVksR0FBWjtRQUNFLE9BQU8sSUFBSSxDQUFDLHNCQUFzQixDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFFRDs7O09BR0c7SUFDSCxtQ0FBUyxHQUFUO1FBQ0UsT0FBTyxJQUFJLENBQUMsc0JBQXNCLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDL0MsQ0FBQztJQUVEOzs7T0FHRztJQUNILG9DQUFVLEdBQVY7UUFDRSxPQUFPLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUNoRCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsc0NBQVksR0FBWjtRQUNFLE9BQU8sSUFBSSxDQUFDLHNCQUFzQixDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFPRCw4QkFBSTtJQVdKLDhCQUFJLGFBQUMsSUFBeUIsRUFBRSxHQUFXO0lBWTNDLCtCQUFLLGFBQUMsSUFBeUIsRUFBRSxJQUFZLEVBQUUsTUFBYzs7Ozs7O0lBNUZsRCxlQUFlO1FBRDNCLFVBQVUsRUFBRTtPQUNBLGVBQWU7MEJBOUc1QjtFQThHcUMsaUJBQWlCO1NBQXpDLGVBQWUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFBsdWdpbiwgQ29yZG92YSwgSW9uaWNOYXRpdmVQbHVnaW4gfSBmcm9tICdAaW9uaWMtbmF0aXZlL2NvcmUnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XHJcblxyXG5kZWNsYXJlIGNvbnN0IHdpbmRvdzogYW55O1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBXZWJTb2NrZXRJbnRlcmZhY2VzIHtcclxuICBba2V5OiBzdHJpbmddOiBXZWJTb2NrZXRJbnRlcmZhY2U7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgV2ViU29ja2V0SW50ZXJmYWNlIHtcclxuICBpcHY0QWRkcmVzc2VzOiBzdHJpbmdbXTtcclxuICBpcHY2QWRkcmVzc2VzOiBzdHJpbmdbXTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBXZWJTb2NrZXRPcHRpb25zIHtcclxuICBvcmlnaW5zPzogc3RyaW5nW107XHJcbiAgcHJvdG9jb2xzPzogc3RyaW5nW107XHJcbiAgdGNwTm9EZWxheT86IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgV2ViU29ja2V0SWRlbnRpZmllciB7XHJcbiAgdXVpZDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFdlYlNvY2tldFNlcnZlckRldGFpbHMge1xyXG4gIGFkZHI6IHN0cmluZztcclxuICBwb3J0OiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgV2ViU29ja2V0RmFpbHVyZSBleHRlbmRzIFdlYlNvY2tldFNlcnZlckRldGFpbHMge1xyXG4gIHJlYXNvbjogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFdlYlNvY2tldE1lc3NhZ2Uge1xyXG4gIGNvbm46IFdlYlNvY2tldENvbm5lY3Rpb247XHJcbiAgbXNnOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgV2ViU29ja2V0Q2xvc2Uge1xyXG4gIGNvbm46IFdlYlNvY2tldENvbm5lY3Rpb247XHJcbiAgY29kZTogbnVtYmVyO1xyXG4gIHJlYXNvbjogc3RyaW5nO1xyXG4gIHdhc0NsZWFuOiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFdlYlNvY2tldENvbm5lY3Rpb24gZXh0ZW5kcyBXZWJTb2NrZXRJZGVudGlmaWVyIHtcclxuICByZW1vdGVBdHRyOiBzdHJpbmc7XHJcbiAgc3RhdGU6ICdvcGVuJyB8ICdjbG9zZWQnO1xyXG4gIGh0dHBGaWVsZHM6IEh0dHBGaWVsZHM7XHJcbiAgcmVzb3VyY2U6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBIdHRwRmllbGRzIHtcclxuICAnQWNjZXB0LUVuY29kaW5nJzogc3RyaW5nO1xyXG4gICdBY2NlcHQtTGFuZ3VhZ2UnOiBzdHJpbmc7XHJcbiAgJ0NhY2hlLUNvbnRyb2wnOiBzdHJpbmc7XHJcbiAgQ29ubmVjdGlvbjogc3RyaW5nO1xyXG4gIEhvc3Q6IHN0cmluZztcclxuICBPcmlnaW46IHN0cmluZztcclxuICBQcmFnbWE6IHN0cmluZztcclxuICAnU2VjLVdlYlNvY2tldC1FeHRlbnNpb25zJzogc3RyaW5nO1xyXG4gICdTZWMtV2ViU29ja2V0LUtleSc6IHN0cmluZztcclxuICAnU2VjLVdlYlNvY2tldC1WZXJzaW9uJzogc3RyaW5nO1xyXG4gIFVwZ3JhZGU6IHN0cmluZztcclxuICAnVXNlci1BZ2VudCc6IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIEBuYW1lIFdlYlNvY2tldCBTZXJ2ZXJcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIFRoaXMgcGx1Z2luIGFsbG93cyB5b3UgdG8gcnVuIGEgc2luZ2xlLCBsaWdodHdlaWdodCwgYmFyZWJvbmUgV2ViU29ja2V0IFNlcnZlci5cclxuICpcclxuICogQHVzYWdlXHJcbiAqIGBgYHR5cGVzY3JpcHRcclxuICogaW1wb3J0IHsgV2ViU29ja2V0U2VydmVyIH0gZnJvbSAnQGlvbmljLW5hdGl2ZS93ZWItc29ja2V0LXNlcnZlcic7XHJcbiAqXHJcbiAqIGNvbnN0cnVjdG9yKHByaXZhdGUgd3NzZXJ2ZXI6IFdlYlNvY2tldFNlcnZlcikgeyB9XHJcbiAqXHJcbiAqIC4uLlxyXG4gKlxyXG4gKiAvLyBzdGFydCB3ZWJzb2NrZXQgc2VydmVyXHJcbiAqIHRoaXMud3NzZXJ2ZXIuc3RhcnQoODg4OCwge30pLnN1YnNjcmliZSh7XHJcbiAqICAgbmV4dDogc2VydmVyID0+IGNvbnNvbGUubG9nKGBMaXN0ZW5pbmcgb24gJHtzZXJ2ZXIuYWRkcn06JHtzZXJ2ZXIucG9ydH1gKSxcclxuICogICBlcnJvcjogZXJyb3IgPT4gY29uc29sZS5sb2coYFVuZXhwZWN0ZWQgZXJyb3JgLCBlcnJvcik7XHJcbiAqIH0pO1xyXG4gKlxyXG4gKiAvLyB3YXRjaCBmb3IgYW55IG1lc3NhZ2VzXHJcbiAqIHRoaXMud3NzZXJ2ZXIud2F0Y2hNZXNzYWdlKCkuc3Vic2NyaWJlKHJlc3VsdCA9PiB7XHJcbiAqICAgY29uc29sZS5sb2coYFJlY2VpdmVkIG1lc3NhZ2UgJHtyZXN1bHQubXNnfSBmcm9tICR7cmVzdWx0LmNvbm4udXVpZH1gKTtcclxuICogfSk7XHJcbiAqXHJcbiAqIC8vIHNlbmQgbWVzc2FnZSB0byBjb25uZWN0aW9uIHdpdGggc3BlY2lmaWVkIHV1aWRcclxuICogdGhpcy53c3NlcnZlci5zZW5kKHsgdXVpZDogJzhlN2M0ZjQ4LWRlNjgtNGI2Zi04ZmNhLTEwNjdhMzUzOTY4ZCcgfSwgJ0hlbGxvIFdvcmxkJyk7XHJcbiAqXHJcbiAqIC8vIHN0b3Agd2Vic29ja2V0IHNlcnZlclxyXG4gKiB0aGlzLndzc2VydmVyLnN0b3AoKS50aGVuKHNlcnZlciA9PiB7XHJcbiAqICAgY29uc29sZS5sb2coYFN0b3AgbGlzdGVuaW5nIG9uICR7c2VydmVyLmFkZHJ9OiR7c2VydmVyLnBvcnR9YCk7XHJcbiAqIH0pO1xyXG4gKlxyXG4gKiBgYGBcclxuICovXHJcbkBQbHVnaW4oe1xyXG4gIHBsdWdpbk5hbWU6ICdXZWJTb2NrZXRTZXJ2ZXInLFxyXG4gIHBsdWdpbjogJ2NvcmRvdmEtcGx1Z2luLXdlYnNvY2tldC1zZXJ2ZXInLFxyXG4gIHBsdWdpblJlZjogJ2NvcmRvdmEucGx1Z2lucy53c3NlcnZlcicsXHJcbiAgcmVwbzogJ2h0dHBzOi8vZ2l0aHViLmNvbS9iZWN2ZXJ0L2NvcmRvdmEtcGx1Z2luLXdlYnNvY2tldC1zZXJ2ZXInLFxyXG4gIHBsYXRmb3JtczogWydBbmRyb2lkJywgJ2lPUyddLFxyXG59KVxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBXZWJTb2NrZXRTZXJ2ZXIgZXh0ZW5kcyBJb25pY05hdGl2ZVBsdWdpbiB7XHJcbiAgLyoqXHJcbiAgICogUmV0dXJuIHRoaXMgZGV2aWNlJ3MgaW50ZXJmYWNlc1xyXG4gICAqIEByZXR1cm4ge1Byb21pc2U8V2ViU29ja2V0SW50ZXJmYWNlcz59XHJcbiAgICovXHJcbiAgQENvcmRvdmEoKVxyXG4gIGdldEludGVyZmFjZXMoKTogUHJvbWlzZTxXZWJTb2NrZXRJbnRlcmZhY2VzPiB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTdGFydCB3ZWJzb2NrZXQgc2VydmVyXHJcbiAgICogQHBhcmFtIHBvcnQge251bWJlcn0gTG9jYWwgcG9ydCBvbiB3aGljaCB0aGUgc2VydmljZSBydW5zLiAoMCBtZWFucyBhbnkgZnJlZSBwb3J0KVxyXG4gICAqIEBwYXJhbSBvcHRpb25zIHtXZWJTb2NrZXRPcHRpb25zfSBBZGRpdGlvbmFsIG9wdGlvbnMgZm9yIHdlYnNvY2tldFxyXG4gICAqIEByZXR1cm4ge09ic2VydmFibGU8V2ViU29ja2V0U2VydmVyRGV0YWlscz59IFJldHVybnMgT2JzZXJ2YWJsZSB3aGVyZSBhbGwgZ2VuZXJpYyBlcnJvciBjYW4gYmUgY2F0Y2hlZCAobW9zdGx5IEpTT05FeGNlcHRpb25zKVxyXG4gICAqL1xyXG4gIEBDb3Jkb3ZhKHtcclxuICAgIG9ic2VydmFibGU6IHRydWUsXHJcbiAgICBjbGVhckZ1bmN0aW9uOiAnc3RvcCcsXHJcbiAgfSlcclxuICBzdGFydChwb3J0OiBudW1iZXIsIG9wdGlvbnM6IFdlYlNvY2tldE9wdGlvbnMpOiBPYnNlcnZhYmxlPFdlYlNvY2tldFNlcnZlckRldGFpbHM+IHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgb25GdW5jdGlvblRvT2JzZXJ2YWJsZTxUPihmbk5hbWU6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPFQ+KG9ic2VydmVyID0+IHtcclxuICAgICAgY29uc3QgaWQgPSB3aW5kb3cuY29yZG92YS5wbHVnaW5zLndzc2VydmVyW2ZuTmFtZV0ob2JzZXJ2ZXIubmV4dC5iaW5kKG9ic2VydmVyKSwgb2JzZXJ2ZXIuZXJyb3IuYmluZChvYnNlcnZlcikpO1xyXG5cclxuICAgICAgcmV0dXJuICgpID0+IHdpbmRvdy5jb3Jkb3ZhLnBsdWdpbnMud3NzZXJ2ZXIucmVtb3ZlQ2FsbGJhY2soaWQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXYXRjaGVzIGZvciBuZXcgbWVzc2FnZXNcclxuICAgKiBAcmV0dXJuIHtPYnNlcnZhYmxlPFdlYlNvY2tldE1lc3NhZ2U+fVxyXG4gICAqL1xyXG4gIHdhdGNoTWVzc2FnZSgpOiBPYnNlcnZhYmxlPFdlYlNvY2tldE1lc3NhZ2U+IHtcclxuICAgIHJldHVybiB0aGlzLm9uRnVuY3Rpb25Ub09ic2VydmFibGUoJ29uTWVzc2FnZScpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogV2F0Y2hlcyBmb3IgbmV3IG9wZW5lZCBjb25uZWN0aW9uc1xyXG4gICAqIEByZXR1cm4ge09ic2VydmFibGU8V2ViU29ja2V0Q29ubmVjdGlvbj59XHJcbiAgICovXHJcbiAgd2F0Y2hPcGVuKCk6IE9ic2VydmFibGU8V2ViU29ja2V0Q29ubmVjdGlvbj4ge1xyXG4gICAgcmV0dXJuIHRoaXMub25GdW5jdGlvblRvT2JzZXJ2YWJsZSgnb25PcGVuJyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXYXRjaGVzIGZvciBjbG9zZWQgY29ubmVjdGlvbnNcclxuICAgKiBAcmV0dXJuIHtPYnNlcnZhYmxlPFdlYlNvY2tldENsb3NlPn1cclxuICAgKi9cclxuICB3YXRjaENsb3NlKCk6IE9ic2VydmFibGU8V2ViU29ja2V0Q2xvc2U+IHtcclxuICAgIHJldHVybiB0aGlzLm9uRnVuY3Rpb25Ub09ic2VydmFibGUoJ29uQ2xvc2UnKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFdhdGNoZXMgZm9yIGFueSB3ZWJzb2NrZXQgZmFpbHVyZXNcclxuICAgKiBAcmV0dXJuIHtPYnNlcnZhYmxlPFdlYlNvY2tldEZhaWx1cmU+fVxyXG4gICAqL1xyXG4gIHdhdGNoRmFpbHVyZSgpOiBPYnNlcnZhYmxlPFdlYlNvY2tldEZhaWx1cmU+IHtcclxuICAgIHJldHVybiB0aGlzLm9uRnVuY3Rpb25Ub09ic2VydmFibGUoJ29uRmFpbHVyZScpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RvcCB3ZWJzb2NrZXQgc2VydmVyIGFuZCBjbG9zZXMgYWxsIGNvbm5lY3Rpb25zXHJcbiAgICogQHJldHVybiB7UHJvbWlzZTxXZWJTb2NrZXRTZXJ2ZXJEZXRhaWxzPn1cclxuICAgKi9cclxuICBAQ29yZG92YSgpXHJcbiAgc3RvcCgpOiBQcm9taXNlPFdlYlNvY2tldFNlcnZlckRldGFpbHM+IHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNlbmQgTWVzc2FnZSB0byBhIGNvbm5lY3RlZCBkZXZpY2VcclxuICAgKiBAcGFyYW0gY29ubiB7V2ViU29ja2V0SWRlbnRpZmllcn0gQ29ubmVjdGlvbiB0byBzZW5kIG1lc3NhZ2UgdG9cclxuICAgKiBAcGFyYW0gbXNnIHtzdHJpbmd9IE1lc3NhZ2UgdG8gc2VuZFxyXG4gICAqIEByZXR1cm4ge1Byb21pc2U8dm9pZD59XHJcbiAgICovXHJcbiAgQENvcmRvdmEoKVxyXG4gIHNlbmQoY29ubjogV2ViU29ja2V0SWRlbnRpZmllciwgbXNnOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsb3NlIHNwZWNpZmljIGNvbm5lY3Rpb24gdXNpbmcgdXVpZFxyXG4gICAqIEBwYXJhbSBjb25uIHtXZWJTb2NrZXRJZGVudGlmaWVyfSBDb25uZWN0aW9uIHRvIGNsb3NlXHJcbiAgICogQHBhcmFtIGNvZGUge251bWJlcn0gQ2xvc2UgY29kZSwgZGV0ZXJtaW5lcyBpZiBpdCB3YXMgY2xlYW5cclxuICAgKiBAcGFyYW0gcmVhc29uIHtzdHJpbmd9IFJlYXNvbiBmb3IgY2xvc2luZ1xyXG4gICAqIEByZXR1cm4ge1Byb21pc2U8dm9pZD59XHJcbiAgICovXHJcbiAgQENvcmRvdmEoKVxyXG4gIGNsb3NlKGNvbm46IFdlYlNvY2tldElkZW50aWZpZXIsIGNvZGU6IG51bWJlciwgcmVhc29uOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHJldHVybjtcclxuICB9XHJcbn1cclxuIl19